import pandas as pd
import numpy as np

df = pd.read_csv('footprint_test.csv')

grouped_df = df.groupby('open time').agg(lambda x: list(x))

# This function lumps values in a list by summing every lump_num elements together. It returns a new list with the lumped values.
def lump_values(lst,lump_num=10): return [sum(lst[i:i+lump_num]) for i in range(0, len(lst), lump_num)]

grouped_df['buy vol'] = grouped_df['buy vol'].apply(lump_values)
grouped_df['buy count'] = grouped_df['buy count'].apply(lump_values)
grouped_df['sell vol'] = grouped_df['sell vol'].apply(lump_values)
grouped_df['sell count'] = grouped_df['sell count'].apply(lump_values)

print(grouped_df["buy vol"])
print(grouped_df["buy count"])
print(grouped_df["sell vol"])
print(grouped_df["sell count"])


'''[OUT]'''
# open time
# 1.638576e+09    [164820.59999999998, 107.074, 153553.224, 3336...
# 1.638576e+09    [236811.57349999997, 536.655, 6441.06, 146163....
# 1.638577e+09    [1878321.7905000001, 45900.365, 1505.033999999...
# 1.638577e+09    [326841.23000000004, 666262.3985, 0.0, 0.0, 27...
# 1.638578e+09    [511362.1915, 532281.3060000001, 2780.044, 534...
#                                       ...                        
# 1.638659e+09    [1092843.5700000003, 0.0, 0.0, 812219.01, 3496...
# 1.638660e+09    [0.0, 0.0, 0.0, 1564.736, 0.0, 0.0, 811508.145...
# 1.638661e+09    [27449.204, 976.99, 4299.063999999999, 147648....
# 1.638662e+09    [242405.54000000004, 0.0, 0.0, 1757.898, 27248...
# 1.638662e+09    [0.0, 701295.8940000001, 311687.064, 0.0, 7371...
# Name: buy vol, Length: 439, dtype: object
# open time
# 1.638576e+09    [13.0, 2.0, 21.0, 24.0, 23.0, 26.0, 50.0, 9.0,...
# 1.638576e+09    [32.0, 10.0, 7.0, 32.0, 21.0, 22.0, 14.0, 20.0...
# 1.638577e+09    [42.0, 3.0, 15.0, 4.0, 3.0, 42.0, 31.0, 29.0, ...
# 1.638577e+09    [19.0, 4.0, 0.0, 0.0, 6.0, 9.0, 5.0, 8.0, 9.0,...
# 1.638578e+09    [45.0, 87.0, 13.0, 3.0, 4.0, 24.0, 17.0, 2.0, ...
#                                       ...                        
# 1.638659e+09    [70.0, 0.0, 0.0, 12.0, 27.0, 12.0, 10.0, 34.0,...
# 1.638660e+09    [0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 24.0, 0.0, 3.0,...
# 1.638661e+09    [6.0, 1.0, 8.0, 38.0, 3.0, 0.0, 7.0, 26.0, 117...
# 1.638662e+09    [105.0, 0.0, 0.0, 2.0, 14.0, 0.0, 11.0, 75.0, ...
# 1.638662e+09    [0.0, 36.0, 16.0, 0.0, 3.0, 26.0, 17.0, 8.0, 2...
# Name: buy count, Length: 439, dtype: object
# open time
# 1.638576e+09    [125849.58250000002, 17078.9325, 32553.9125, 4...
# 1.638576e+09    [80762.08249999999, 0.0, 2576.3709999999996, 0...
# 1.638577e+09    [78780.09649999997, 19187.6325, 110511.62, 325...
# 1.638577e+09    [338244.573, 50133.445499999994, 3803.00749999...
# 1.638578e+09    [288848.1055, 49768.758499999996, 19619.859999...
#                                       ...                        
# 1.638659e+09    [52088.81400000001, 233323.186, 41149.56750000...
# 1.638660e+09    [219141.93099999998, 45027.0525, 227201.903, 5...
# 1.638661e+09    [17778.693, 204680.724, 672689.8890000001, 855...
# 1.638662e+09    [796625.6085, 486919.12200000003, 79878.6765, ...
# 1.638662e+09    [982.5099999999999, 564804.2279999999, 144464....
# Name: sell vol, Length: 439, dtype: object
# open time
# 1.638576e+09    [24.0, 31.0, 14.0, 27.0, 15.0, 20.0, 43.0, 7.0...
# 1.638576e+09    [12.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0,...
# 1.638577e+09    [26.0, 22.0, 30.0, 13.0, 17.0, 5.0, 9.0, 16.0,...
# 1.638577e+09    [68.0, 14.0, 16.0, 29.0, 18.0, 57.0, 23.0, 46....
# 1.638578e+09    [69.0, 21.0, 12.0, 18.0, 21.0, 51.0, 15.0, 41....
#                                       ...                        
# 1.638659e+09    [8.0, 52.0, 19.0, 56.0, 23.0, 12.0, 48.0, 70.0...
# 1.638660e+09    [23.0, 14.0, 66.0, 21.0, 10.0, 12.0, 34.0, 16....
# 1.638661e+09    [16.0, 26.0, 25.0, 15.0, 29.0, 14.0, 11.0, 8.0...
# 1.638662e+09    [38.0, 21.0, 13.0, 14.0, 5.0, 25.0, 8.0, 43.0,...
# 1.638662e+09    [10.0, 15.0, 24.0, 37.0, 21.0, 11.0, 0.0, 6.0,...
# Name: sell count, Length: 439, dtype: object